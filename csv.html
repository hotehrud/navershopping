<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Table to CSV</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <style>
        table, th, tr, td {
            border: 1px solid black;
        }

    </style>
</head>
<body>
<div>
    <button id="addRow">추가</button>
    <button id="tsvWrite">저장</button>
    <button id="removeRow">삭제</button>
</div>
<div id="table"></div>


<script>
    $(function() {
        var variable = {};

        $('#addRow').on('click', function() {
            console.log("추가");

            var tr = document.createElement('tr');

            for(var i=0;i<variable.colNumber;i++) {
                tr.appendChild(createTr(''));
            }

            $('#table > table').append(tr);
        })

        $(function() {
            $.ajax({
                type: "GET",
                url: "/navershopping.txt",
                dataType: "text",
                success: function(data) {
                    processData(data);
                }
            });
        });

        function processData(str) {
            var x = str.split('\n');
            for (var i=0; i<x.length; i++) {
                var y = x[i].split('\t');
                x[i] = y;
            }

            variable.colNumber = x[0].length;

            var array = x;
            var arrayLength = array.length;
            var theTable = document.createElement('table');

            // Note, don't forget the var keyword!
            for (var i=0;i<arrayLength;i++) {
                if (array[i][0] == '') {
                    break;
                }

                var tr = document.createElement('tr');

                $.each(array[i], function(index, value) {
                    tr.appendChild(createTr(value));
                });

                theTable.appendChild(tr);
            }

            document.getElementById('table').appendChild(theTable);
        }

        function createTr(value) {
            var td = document.createElement('td');
            var input = document.createElement("input");
            input.setAttribute("type", "text");
            input.setAttribute("value", value);

            td.appendChild(input);

            return td;
        }
    })

</script>
</body>
</html>