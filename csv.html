<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Table to TSV</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
    <style>
        table, th, tr, td {
            border: 1px solid black;
        }
    </style>
</head>
<body>
<div>
    <button id="addRow">추가</button>
    <button id="tsvWrite">저장</button>
    <button id="removeRow">삭제</button>
</div>
<div id="table"></div>


<script>
    $(function() {
        'use strict';

        var mygumi = {},
                variable = {};

        mygumi.init = function() {
            mygumi.event;

            mygumi.start();
        }

        mygumi.start = function() {

            mygumi.async.readTsvFile(mygumi.dom.createInitTable);

        }

        mygumi.event = (function() {
            var event = {};

            event.autoEvent = {
                addRowEvent : function() {
                    $('#addRow').on('click', function() {
                        console.log("추가");
                        var tr = document.createElement('tr');
                        for(var i=0;i<variable['colNumber'];i++) {
                            tr.appendChild(mygumi.dom.addRow(''));
                        }
                        $('#table > table').append(tr);
                        console.log("addRow");
                    });
                },
                test : function() {
                    console.log("test")
                }
            }

            var autoEventFnc = (function() {
                var autoEventObj = event.autoEvent;

                for (var property in autoEventObj) {
                    if (autoEventObj.hasOwnProperty(property)) {
                        autoEventObj[property].call();
                    }
                }

            }());

            return event;
        }());

        mygumi.async = (function() {
            var async = {};

            async.readTsvFile = function(callback) {
                $.ajax({
                    type: "GET",
                    url: "navershopping.txt",
                    dataType: "text",
                    success: function(str) {
                        var item = str.split('\n');

                        for (var i=0; i<item.length; i++) {
                            var columnValue = item[i].split('\t');
                            item[i] = columnValue;
                        }

                        variable['colNumber'] = item[0].length;

                        callback(item);
                    }
                });
            }

            return async;
        }());

        mygumi.dom = (function() {
            var dom = {};

            dom.createInitTable = function(tsv) {
                var array = tsv;
                var arrayLength = array.length;
                var theTable = document.createElement('table');
                // Note, don't forget the var keyword!
                for (var i=0;i<arrayLength;i++) {
                    if (array[i][0] == '') {
                        break;
                    }
                    var tr = document.createElement('tr');
                    $.each(array[i], function(index, value) {
                        tr.appendChild(dom.addRow(value));
                    });
                    theTable.appendChild(tr);
                }
                document.getElementById('table').appendChild(theTable);
            }

            dom.addRow = function(value) {
                var td = document.createElement('td');
                var input = document.createElement("input");
                input.setAttribute("type", "text");
                input.setAttribute("value", value);
                td.appendChild(input);

                return td;
            }

            return dom;
        }());

        mygumi.init();

    })
</script>
</body>
</html>